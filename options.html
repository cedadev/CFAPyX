


<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>cfapyx Usage and Options &mdash; CFAPyX Package 2024.10.11 documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=e59714d7" />

  
    <link rel="shortcut icon" href="_static/CFAPyX.ico"/>
      <script src="_static/jquery.js?v=5d32c60e"></script>
      <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="_static/documentation_options.js?v=b1adf121"></script>
      <script src="_static/doctools.js?v=9a2dae69"></script>
      <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="CFA Creator" href="creator_use.html" />
    <link rel="prev" title="cfapyx Terminology" href="fragments.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            CFAPyX Package
              <img src="_static/CFAPyX_long.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Details:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="inspiration.html">Inspiration for CFA</a></li>
<li class="toctree-l1"><a class="reference internal" href="overview.html">Xarray Engine Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="fragments.html">Fragments, Partitions and Chunks</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">cfapyx Usage and Options</a></li>
<li class="toctree-l1"><a class="reference internal" href="creator_use.html">CFA Creator Usage</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API Reference</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="creator.html">CFA Creator</a></li>
<li class="toctree-l1"><a class="reference internal" href="backend.html">CFA Backend Entrypoint</a></li>
<li class="toctree-l1"><a class="reference internal" href="datastore.html">CFA DataStore</a></li>
<li class="toctree-l1"><a class="reference internal" href="wrapper.html">CFA Wrappers</a></li>
<li class="toctree-l1"><a class="reference internal" href="groups.html">CFA Groups</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">CFAPyX Package</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">cfapyx Usage and Options</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/options.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="cfapyx-usage-and-options">
<h1>cfapyx Usage and Options<a class="headerlink" href="#cfapyx-usage-and-options" title="Link to this heading"></a></h1>
<p>The cfapyx engine ‘CFA’ is enabled using the <code class="docutils literal notranslate"><span class="pre">engine</span></code> keyword to Xarray as follows:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ds</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">open_dataset</span><span class="p">(</span><span class="n">cfa_file</span><span class="p">,</span> <span class="n">engine</span><span class="o">=</span><span class="s1">&#39;CFA&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">ds</span></code> object can then be used as normal in Xarray. Keyword arguments are provided to cfapyx with the following syntax:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ds</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">open_dataset</span><span class="p">(</span><span class="n">cfa_file</span><span class="p">,</span> <span class="n">engine</span><span class="o">=</span><span class="s1">&#39;CFA&#39;</span><span class="p">,</span>
                    <span class="n">cfa_options</span> <span class="o">=</span> <span class="p">{</span>
                            <span class="s1">&#39;substitutions&#39;</span> <span class="p">:</span> <span class="p">{</span><span class="s1">&#39;base&#39;</span><span class="p">:</span><span class="s1">&#39;sub&#39;</span><span class="p">},</span>
                            <span class="s1">&#39;decode_cfa&#39;</span> <span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
                            <span class="s1">&#39;chunks&#39;</span> <span class="p">:</span> <span class="p">{}</span>
                        <span class="p">}</span>
                    <span class="p">)</span>
</pre></div>
</div>
<dl class="simple">
<dt>Three keyword arguments are currently supported within <code class="docutils literal notranslate"><span class="pre">cfa_options</span></code>:</dt><dd><ul class="simple">
<li><p><strong>Substitutions</strong>: Additional substitutions provided to the CFA decoder for this file, following the CF 1.12 conventions
for syntax with ‘base’ and ‘sub’.</p></li>
<li><p><strong>Decode CFA</strong>: Optional parameter to disable decoding of aggregation variables if required. Default is True.</p></li>
<li><p><strong>Chunks</strong>: Replaces the typical <code class="docutils literal notranslate"><span class="pre">chunks={}</span></code> normally provided to Xarray for Dask chunks. You can still use the normal
dask chunks keyword but may get better performance using CFA chunks because this takes into account the underlying storage
regime including Fragment extents. See the diagram in <a class="reference internal" href="fragments.html#fragments-chunks-and-partitions"><span class="std std-ref">Fragments, Chunks and Partitions</span></a> for more details.</p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The <code class="docutils literal notranslate"><span class="pre">chunks</span></code> option for cfapyx now includes an additional option: <code class="docutils literal notranslate"><span class="pre">optimised</span></code>. This is an upgrade from the dask <code class="docutils literal notranslate"><span class="pre">auto</span></code>
chunks option, where the chunk size is automatically calculated by dask, then shifted such that the number of chunks approaches
a power of 2. This has significant computational performance benefits.</p>
</div>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="fragments.html" class="btn btn-neutral float-left" title="cfapyx Terminology" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="creator_use.html" class="btn btn-neutral float-right" title="CFA Creator" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022-2024, Centre of Environmental Data Analysis Developers,Scientific and Technical Facilities Council (STFC),UK Research and Innovation (UKRI). BSD 2-Clause License. All rights reserved.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>  

  <style>
    /* Sidebar header (and topbar for mobile) */
    .wy-side-nav-search, .wy-nav-top {
      background: #0ecc5778;
    }

    .caption-text, .header h1 {
        color: #45c347
    }

    .note {
        background: #BEEF9E
    }
    .admonition-title {
        background: #335145
    }

    .wy-nav-side {
        background: #001711;
    }

  </style>


</body>
</html>